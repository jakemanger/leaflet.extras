{"version":3,"file":"lfx-search-bindings.js","mappings":"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","sources":["webpack://leaflet.extras/./inst/htmlwidgets/bindings/lfx-search-bindings.js"],"sourcesContent":["/* global $, LeafletWidget, L, Shiny, HTMLWidgets, google */\n\n// helper function to conver JS event to Shiny Event\nfunction eventToShiny(e) {\n  var shinyEvent = {};\n  shinyEvent.latlng = {};\n  shinyEvent.latlng.lat = e.latlng.lat;\n  shinyEvent.latlng.lng = e.latlng.lng;\n  if(!$.isEmptyObject(e.title)) {\n    shinyEvent.title = e.title;\n  }\n  if(!$.isEmptyObject(e.layer)) {\n    shinyEvent.layer = e.layer.toGeoJSON();\n  }\n  return shinyEvent;\n}\n\nLeafletWidget.methods.addSearchOSM = function(options) {\n\n  (function(){\n    var map = this;\n\n    if(map.searchControlOSM) {\n      map.searchControlOSM.removeFrom(map);\n      delete map.searchControlOSM;\n    }\n\n    options = options || {};\n    // default\n    //options.textPlaceholder = 'Search using OSM Geocoder';\n    //options.url = 'https://nominatim.openstreetmap.org/search?format=json&q={s}';\n    options.jsonpParam = 'json_callback';\n    options.propertyName = 'display_name';\n    options.propertyLoc = ['lat','lon'];\n\n    // https://github.com/stefanocudini/leaflet-search/issues/129\n    options.marker = L.circleMarker([0,0],{radius:30});\n\n    if(options.moveToLocation) {\n      options.moveToLocation = function(latlng, title, map) {\n        var zoom = options.zoom || 16;\n        var maxZoom = map.getMaxZoom();\n        if(maxZoom && zoom > maxZoom) {\n          zoom = maxZoom;\n        }\n        map.setView(latlng, zoom);\n      };\n    }\n\n    map.searchControlOSM = new L.Control.Search(options);\n    map.searchControlOSM.addTo(map);\n\n    map.searchControlOSM.on('search:locationfound', function(e){\n      // Shiny stuff\n      if (!HTMLWidgets.shinyMode) return;\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\n    });\n\n  }).call(this);\n};\n\nLeafletWidget.methods.removeSearchOSM = function() {\n  (function(){\n\n    var map = this;\n\n    if(map.searchControlOSM) {\n      map.searchControlOSM.removeFrom(map);\n      delete map.searchControlOSM;\n    }\n  }).call(this);\n};\n\nLeafletWidget.methods.addReverseSearchOSM = function(options, group) {\n  (function() {\n\n    var map = this;\n\n    group = group || 'reverse_search_osm' ;\n    map.layerManager.clearGroup(group);\n\n    var displayControl = document.getElementById('reverseSearchOSM');\n\n    var searchURL = 'https://nominatim.openstreetmap.org/reverse?format=json&polygon_geojson=1';\n\n    map.on('click', function(e){\n\n      var latlng = e.latlng;\n\n      // This will hold the query, boundingbox, and found feature layers\n      var container = L.featureGroup();\n      var layerID = L.stamp(container);\n\n      if(options.showSearchLocation) {\n        var marker = L.marker(e.latlng,{'type': 'query'}).bindTooltip(\n          'lat='+latlng.lat+' lng='+latlng.lng+'</P>');\n        /* eslint-disable no-unused-vars */\n        var m_layerID = L.stamp(marker);\n        /* eslint-enable no-unused-vars */\n        container.addLayer(marker);\n      }\n\n      var query = searchURL + '&lat=' + latlng.lat + '&lon=' + latlng.lng;\n\n      $.ajax({url: query, dataType: 'json'}).done(function(result){\n\n        if(!$.isEmptyObject(displayControl)) {\n          var displayText = '<div>';\n          displayText = displayText + 'Display Name: ' +\n            ( (result.display_name) ?  result.display_name : '' ) + '<br/>';\n          displayText =  displayText + '</div>';\n          displayControl.innerHTML = displayText;\n        }\n\n        var bb = L.latLngBounds(\n          L.latLng(result.boundingbox[0],result.boundingbox[2]),\n          L.latLng(result.boundingbox[1], result.boundingbox[3]));\n\n        if(options.showBounds) {\n          var rect = L.rectangle(bb, {\n            weight:2, color: '#444444', clickable: false,\n            dashArray: '5,10', 'type': 'result_boundingbox'});\n          /* eslint-disable no-unused-vars */\n          var bb_layerID = L.stamp(rect);\n          /* eslint-enable no-unused-vars */\n          container.addLayer(rect);\n        }\n\n        if(options.showFeature) {\n          var feature = L.geoJson(result.geojson,\n            {\n              weight:2, color: 'red', dashArray: '5,10',\n              clickable : false, 'type': 'result_feature',\n              pointToLayer: function(feature, latlng) {\n                return L.circleMarker(latlng,{\n                  weight:2, color: 'red', dashArray: '5,10', clickable : false});\n              }\n            });\n\n          /* eslint-disable no-unused-vars */\n          var f_layerID = L.stamp(feature);\n          /* eslint-enable no-unused-vars */\n          container.addLayer(feature);\n        }\n\n        var tmp = container.getLayers();\n        if(!$.isEmptyObject(tmp) && tmp.length >= 0) {\n\n          if(!$.isEmptyObject(marker)) {\n            marker.on('mouseover', function(e){\n              if(!$.isEmptyObject(rect)) {\n                rect.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\n                rect.bringToFront();\n              }\n              if(!$.isEmptyObject(feature)) {\n                feature.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\n                feature.bringToFront();\n              }\n            });\n            marker.on('mouseout', function(e){\n              if(!$.isEmptyObject(rect)) {\n                rect.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\n                rect.bringToBack();\n              }\n              if(!$.isEmptyObject(feature)) {\n                feature.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\n                feature.bringToBack();\n              }\n            });\n          }\n\n          map.layerManager.addLayer(container, 'search', layerID, group);\n          if(options.fitBounds)\n            map.fitBounds(container.getBounds());\n        }\n\n        if (HTMLWidgets.shinyMode) {\n          Shiny.onInputChange(map.id+'_reverse_search_feature_found',{\n            'query': {'lat': latlng.lat, 'lng': latlng.lng},\n            'result': result\n          });\n        }\n\n      });\n    });\n\n  }).call(this);\n};\n\nLeafletWidget.methods.addSearchGoogle = function(options) {\n\n  (function(){\n    var map = this;\n\n    if(map.searchControlGoogle) {\n      map.searchControlGoogle.removeFrom(map);\n      delete map.searchControlGoogle;\n    }\n\n    var geocoder = new google.maps.Geocoder();\n\n    function googleGeocoding(text, callResponse) {\n      geocoder.geocode({address: text}, callResponse);\n    }\n\n    function formatJSON(rawjson) {\n      var json = {},\n        key, loc;\n\n      for(var i in rawjson) {\n        key = rawjson[i].formatted_address;\n        loc = L.latLng( rawjson[i].geometry.location.lat(), rawjson[i].geometry.location.lng() );\n        json[ key ]= loc; //key,value format\n      }\n      return json;\n    }\n\n    options = options || {};\n    options.markerLocation = true;\n    options.textPlaceholder = 'Search using Google Geocoder';\n\n    // https://github.com/stefanocudini/leaflet-search/issues/129\n    options.marker = L.circleMarker([0,0],{radius:30});\n\n    if(options.moveToLocation) {\n      options.moveToLocation = function(latlng, title, map) {\n        var zoom = options.zoom || 16;\n        var maxZoom = map.getMaxZoom();\n        if(maxZoom && zoom > maxZoom) {\n          zoom = maxZoom;\n        }\n        map.setView(latlng, zoom);\n      };\n    }\n\n    options.sourceData = googleGeocoding;\n    options.formatData = formatJSON;\n\n    map.searchControlGoogle = new L.Control.Search(options);\n    map.searchControlGoogle.addTo(map);\n\n    map.searchControlGoogle.on('search:locationfound', function(e){\n      // Shiny stuff\n      if (!HTMLWidgets.shinyMode) return;\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\n    });\n\n  }).call(this);\n};\n\nLeafletWidget.methods.removeSearchGoogle = function() {\n  (function(){\n\n    var map = this;\n\n    if(map.searchControlGoogle) {\n      map.searchControlGoogle.removeFrom(map);\n      delete map.searchControlGoogle;\n    }\n  }).call(this);\n};\n\nLeafletWidget.methods.addReverseSearchGoogle = function(options, group) {\n  (function() {\n\n    var map = this;\n\n    group = group || 'reverse_search_google' ;\n    map.layerManager.clearGroup(group);\n\n    var displayControl = document.getElementById('reverseSearchGoogle');\n\n    var geocoder = new google.maps.Geocoder();\n\n    map.on('click', function(e){\n\n      var latlng = e.latlng;\n\n      // This will hold the query, boundingbox, and found feature layers\n      var container = L.featureGroup();\n      var layerID = L.stamp(container);\n\n      if(options.showSearchLocation) {\n        var marker = L.marker(e.latlng,{'type': 'query'}).bindTooltip(\n          'lat='+latlng.lat+' lng='+latlng.lng+'</P>');\n        /* eslint-disable no-unused-vars */\n        var m_layerID = L.stamp(marker);\n        /* eslint-enable no-unused-vars */\n        container.addLayer(marker);\n      }\n\n      geocoder.geocode(\n        {'location': {'lat': latlng.lat, 'lng': latlng.lng}},\n        function(results, status) {\n\n          if(status === 'OK') {\n            if(results[0]) {\n              var result = results[0];\n\n              if(!$.isEmptyObject(displayControl)) {\n                var displayText = '<div>';\n                displayText = displayText + 'Address: ' +\n                  ( (result.formatted_address) ?  result.formatted_address : '' ) + '<br/>';\n                displayText =  displayText + '</div>';\n                displayControl.innerHTML = displayText;\n              }\n\n              var bb = L.latLngBounds(\n                L.latLng(result.geometry.viewport.f.f,\n                  result.geometry.viewport.b.b),\n                L.latLng(result.geometry.viewport.f.b,\n                  result.geometry.viewport.b.f));\n\n              if(options.showBounds) {\n                var rect = L.rectangle(bb, {\n                  weight:2, color: '#444444', clickable: false,\n                  dashArray: '5,10', 'type': 'result_boundingbox'});\n                /* eslint-disable no-unused-vars */\n                var bb_layerID = L.stamp(rect);\n                /* eslint-enable no-unused-vars */\n                container.addLayer(rect);\n              }\n\n              if(options.showFeature) {\n                var feature = L.circleMarker(\n                  L.latLng(\n                    result.geometry.location.lat(),\n                    result.geometry.location.lng()\n                  ), {\n                    weight:2, color: 'red', dashArray: '5,10',\n                    clickable : false, 'type': 'result_feature'\n                  }\n                );\n\n                /* eslint-disable no-unused-vars */\n                var f_layerID = L.stamp(feature);\n                /* eslint-disable no-unused-vars */\n                container.addLayer(feature);\n              }\n\n              var tmp = container.getLayers();\n              if(!$.isEmptyObject(tmp) && tmp.length >= 0) {\n\n                if(!$.isEmptyObject(marker)) {\n                  marker.on('mouseover', function(e){\n                    if(!$.isEmptyObject(rect)) {\n                      rect.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\n                      rect.bringToFront();\n                    }\n                    if(!$.isEmptyObject(feature)) {\n                      feature.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\n                      feature.bringToFront();\n                    }\n                  });\n                  marker.on('mouseout', function(e){\n                    if(!$.isEmptyObject(rect)) {\n                      rect.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\n                      rect.bringToBack();\n                    }\n                    if(!$.isEmptyObject(feature)) {\n                      feature.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\n                      feature.bringToBack();\n                    }\n                  });\n                }\n\n                map.layerManager.addLayer(container, 'search', layerID, group);\n                if(options.fitBounds)\n                  map.fitBounds(container.getBounds());\n              }\n\n              if (HTMLWidgets.shinyMode) {\n                Shiny.onInputChange(map.id+'_reverse_search_feature_found',{\n                  'query': {'lat': latlng.lat, 'lng': latlng.lng},\n                  'result': result\n                });\n              }\n            } else {\n              if(!$.isEmptyObject(displayControl))\n                displayControl.innerHTML = 'No Results Found';\n              /* eslint-disable no-console */\n              console.error('No Results Found');\n              /* eslint-enable no-console */\n            }\n          } else {\n            if(!$.isEmptyObject(displayControl))\n              displayControl.innerHTML = 'Reverse Geocoding failed due to: ' + status;\n            /* eslint-disable no-console */\n            console.error('Reverse Geocoing failed due to: ' + status);\n            /* eslint-enable no-console */\n          }\n        }\n      );\n    });\n  }).call(this);\n};\n\n\nLeafletWidget.methods.addSearchUSCensusBureau = function(options) {\n\n  (function(){\n    var map = this;\n\n    if(map.searchControlUSCensusBureau) {\n      map.searchControlUSCensusBureau.removeFrom(map);\n      delete map.searchControlUSCensusBureau;\n    }\n\n    function formatJSON(rawjson) {\n      var json = {}, key, loc;\n\n      for (var i in rawjson.result.addressMatches) {\n        key = rawjson.result.addressMatches[i].matchedAddress;\n        loc = L.latLng(rawjson.result.addressMatches[i].coordinates.y, rawjson.result.addressMatches[i].coordinates.x);\n        json[key] = loc; //key,value format\n      }\n      return json;\n    }\n\n    options = options || {};\n\n    options.url = 'https://geocoding.geo.census.gov/geocoder/locations/onelineaddress?benchmark=Public_AR_Current&format=jsonp&address={s}';\n    options.textPlaceholder = 'Search using US Census Bureau';\n    options.jsonpParam = 'callback';\n    options.formatData = formatJSON;\n\n    // https://github.com/stefanocudini/leaflet-search/issues/129\n    options.marker = L.circleMarker([0,0],{radius:30});\n\n    if(options.moveToLocation) {\n      options.moveToLocation = function(latlng, title, map) {\n        var zoom = options.zoom || 16;\n        var maxZoom = map.getMaxZoom();\n        if(maxZoom && zoom > maxZoom) {\n          zoom = maxZoom;\n        }\n        map.setView(latlng, zoom);\n      };\n    }\n\n    map.searchControlUSCensusBureau = new L.Control.Search(options);\n    map.searchControlUSCensusBureau.addTo(map);\n\n    map.searchControlUSCensusBureau.on('search:locationfound', function(e){\n      // Shiny stuff\n      if (!HTMLWidgets.shinyMode) return;\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\n    });\n\n  }).call(this);\n};\n\nLeafletWidget.methods.removeSearchUSCensusBureau = function() {\n  (function(){\n\n    var map = this;\n\n    if(map.searchControlUSCensusBureau) {\n      map.searchControlUSCensusBureau.removeFrom(map);\n      delete map.searchControlUSCensusBureau;\n    }\n  }).call(this);\n};\n\n\nLeafletWidget.methods.addSearchFeatures = function(targetGroups, options){\n\n  (function(){\n    var map = this;\n\n    if(map.searchControl) {\n      map.searchControl.removeFrom(map);\n      delete map.searchControl;\n    }\n\n    options = options || {};\n\n    if(options.moveToLocation) {\n      options.moveToLocation = function(latlng, title, map) {\n        var zoom = options.zoom || 16;\n        var maxZoom = map.getMaxZoom();\n        if(maxZoom && zoom > maxZoom) {\n          zoom = maxZoom;\n        }\n        map.setView(latlng, zoom);\n      };\n    }\n\n    // FeatureGroup that will be searched\n    var searchFeatureGroup;\n\n    // if we have just one group to search use it.\n    if(!L.Util.isArray(targetGroups)) {\n      var target = map.layerManager.getLayerGroup(targetGroups, false);\n      if(target) {\n        searchFeatureGroup = target;\n        map._searchFeatureGroupName = targetGroups;\n      } else {\n        // throw an error if we can't find the target FeatureGroup layer\n        throw 'Group with ID \"'+targetGroups+'\" not found';\n      }\n    } else { // if we have more than one groups to search create a new seach group with them.\n\n      searchFeatureGroup = map.layerManager.getLayerGroup('search', true);\n      map._searchFeatureGroupName = 'search';\n\n      $.each(targetGroups, function(k, v) {\n        var target = map.layerManager.getLayerGroup(v, false);\n        // may be remove target from map before adding to searchFeatureGroup\n        if(target) {\n          searchFeatureGroup.addLayer(target);\n        } else {\n          /* eslint-disable no-console */\n          console.warn('Group with ID \"' + v + '\" not Found, skipping');\n          /* eslint-enable no-console */\n        }\n      });\n    }\n\n    L.stamp(searchFeatureGroup);\n    options.layer = searchFeatureGroup;\n    map.searchControl = new L.Control.Search(options);\n    map.searchControl.addTo(map);\n\n    map.searchControl.on('search:locationfound', function(e){\n      if(options.openPopup && e.layer._popup) {\n        e.layer.openPopup();\n      }\n      // Shiny stuff\n      if (!HTMLWidgets.shinyMode) return;\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\n    });\n\n  }).call(this);\n};\n\nLeafletWidget.methods.removeSearchFeatures = function(clearFeatures) {\n  (function(){\n\n    var map = this;\n\n    if(map.searchControl) {\n      map.searchControl.removeFrom(map);\n      delete map.searchControl;\n    }\n    if(clearFeatures && map._searchFeatureGroupName) {\n      map.layerManager.clearGroup(map._searchFeatureGroupName);\n      delete map._searchFeatureGroupName ;\n    }\n  }).call(this);\n\n};\n"],"names":["eventToShiny","e","shinyEvent","latlng","lat","lng","$","isEmptyObject","title","layer","toGeoJSON","LeafletWidget","methods","addSearchOSM","options","map","this","searchControlOSM","removeFrom","jsonpParam","propertyName","propertyLoc","marker","L","circleMarker","radius","moveToLocation","zoom","maxZoom","getMaxZoom","setView","Control","Search","addTo","on","HTMLWidgets","shinyMode","Shiny","onInputChange","id","call","removeSearchOSM","addReverseSearchOSM","group","layerManager","clearGroup","displayControl","document","getElementById","container","featureGroup","layerID","stamp","showSearchLocation","bindTooltip","addLayer","query","searchURL","ajax","url","dataType","done","result","displayText","display_name","innerHTML","bb","latLngBounds","latLng","boundingbox","showBounds","rect","rectangle","weight","color","clickable","dashArray","showFeature","feature","geoJson","geojson","pointToLayer","tmp","getLayers","length","setStyle","fillOpacity","opacity","bringToFront","bringToBack","fitBounds","getBounds","addSearchGoogle","searchControlGoogle","geocoder","google","maps","Geocoder","markerLocation","textPlaceholder","sourceData","text","callResponse","geocode","address","formatData","rawjson","key","loc","json","i","formatted_address","geometry","location","removeSearchGoogle","addReverseSearchGoogle","results","status","viewport","f","b","console","error","addSearchUSCensusBureau","searchControlUSCensusBureau","addressMatches","matchedAddress","coordinates","y","x","removeSearchUSCensusBureau","addSearchFeatures","targetGroups","searchFeatureGroup","searchControl","Util","isArray","getLayerGroup","_searchFeatureGroupName","each","k","v","target","warn","openPopup","_popup","removeSearchFeatures","clearFeatures"],"sourceRoot":""}