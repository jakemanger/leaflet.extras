(()=>{function e(e){var o={latlng:{}};return o.latlng.lat=e.latlng.lat,o.latlng.lng=e.latlng.lng,$.isEmptyObject(e.title)||(o.title=e.title),$.isEmptyObject(e.layer)||(o.layer=e.layer.toGeoJSON()),o}LeafletWidget.methods.addSearchOSM=function(o){(function(){var t=this;t.searchControlOSM&&(t.searchControlOSM.removeFrom(t),delete t.searchControlOSM),(o=o||{}).jsonpParam="json_callback",o.propertyName="display_name",o.propertyLoc=["lat","lon"],o.marker=L.circleMarker([0,0],{radius:30}),o.moveToLocation&&(o.moveToLocation=function(e,t,r){var a=o.zoom||16,n=r.getMaxZoom();n&&a>n&&(a=n),r.setView(e,a)}),t.searchControlOSM=new L.Control.Search(o),t.searchControlOSM.addTo(t),t.searchControlOSM.on("search:locationfound",(function(o){HTMLWidgets.shinyMode&&Shiny.onInputChange(t.id+"_search_location_found",e(o))}))}).call(this)},LeafletWidget.methods.removeSearchOSM=function(){(function(){var e=this;e.searchControlOSM&&(e.searchControlOSM.removeFrom(e),delete e.searchControlOSM)}).call(this)},LeafletWidget.methods.addReverseSearchOSM=function(e,o){(function(){var t=this;o=o||"reverse_search_osm",t.layerManager.clearGroup(o);var r=document.getElementById("reverseSearchOSM");t.on("click",(function(a){var n=a.latlng,l=L.featureGroup(),s=L.stamp(l);if(e.showSearchLocation){var i=L.marker(a.latlng,{type:"query"}).bindTooltip("lat="+n.lat+" lng="+n.lng+"</P>");L.stamp(i),l.addLayer(i)}var c="https://nominatim.openstreetmap.org/reverse?format=json&polygon_geojson=1&lat="+n.lat+"&lon="+n.lng;$.ajax({url:c,dataType:"json"}).done((function(a){if(!$.isEmptyObject(r)){var c="<div>";c=c+"Display Name: "+(a.display_name?a.display_name:"")+"<br/>",c+="</div>",r.innerHTML=c}var u=L.latLngBounds(L.latLng(a.boundingbox[0],a.boundingbox[2]),L.latLng(a.boundingbox[1],a.boundingbox[3]));if(e.showBounds){var d=L.rectangle(u,{weight:2,color:"#444444",clickable:!1,dashArray:"5,10",type:"result_boundingbox"});L.stamp(d),l.addLayer(d)}if(e.showFeature){var h=L.geoJson(a.geojson,{weight:2,color:"red",dashArray:"5,10",clickable:!1,type:"result_feature",pointToLayer:function(e,o){return L.circleMarker(o,{weight:2,color:"red",dashArray:"5,10",clickable:!1})}});L.stamp(h),l.addLayer(h)}var g=l.getLayers();!$.isEmptyObject(g)&&g.length>=0&&($.isEmptyObject(i)||(i.on("mouseover",(function(e){$.isEmptyObject(d)||(d.setStyle({fillOpacity:.5,opacity:.8,weight:5}),d.bringToFront()),$.isEmptyObject(h)||(h.setStyle({fillOpacity:.5,opacity:.8,weight:5}),h.bringToFront())})),i.on("mouseout",(function(e){$.isEmptyObject(d)||(d.setStyle({fillOpacity:.2,opacity:.5,weight:2}),d.bringToBack()),$.isEmptyObject(h)||(h.setStyle({fillOpacity:.2,opacity:.5,weight:2}),h.bringToBack())}))),t.layerManager.addLayer(l,"search",s,o),e.fitBounds&&t.fitBounds(l.getBounds())),HTMLWidgets.shinyMode&&Shiny.onInputChange(t.id+"_reverse_search_feature_found",{query:{lat:n.lat,lng:n.lng},result:a})}))}))}).call(this)},LeafletWidget.methods.addSearchGoogle=function(o){(function(){var t=this;t.searchControlGoogle&&(t.searchControlGoogle.removeFrom(t),delete t.searchControlGoogle);var r=new google.maps.Geocoder;(o=o||{}).markerLocation=!0,o.textPlaceholder="Search using Google Geocoder",o.marker=L.circleMarker([0,0],{radius:30}),o.moveToLocation&&(o.moveToLocation=function(e,t,r){var a=o.zoom||16,n=r.getMaxZoom();n&&a>n&&(a=n),r.setView(e,a)}),o.sourceData=function(e,o){r.geocode({address:e},o)},o.formatData=function(e){var o,t,r={};for(var a in e)o=e[a].formatted_address,t=L.latLng(e[a].geometry.location.lat(),e[a].geometry.location.lng()),r[o]=t;return r},t.searchControlGoogle=new L.Control.Search(o),t.searchControlGoogle.addTo(t),t.searchControlGoogle.on("search:locationfound",(function(o){HTMLWidgets.shinyMode&&Shiny.onInputChange(t.id+"_search_location_found",e(o))}))}).call(this)},LeafletWidget.methods.removeSearchGoogle=function(){(function(){var e=this;e.searchControlGoogle&&(e.searchControlGoogle.removeFrom(e),delete e.searchControlGoogle)}).call(this)},LeafletWidget.methods.addReverseSearchGoogle=function(e,o){(function(){var t=this;o=o||"reverse_search_google",t.layerManager.clearGroup(o);var r=document.getElementById("reverseSearchGoogle"),a=new google.maps.Geocoder;t.on("click",(function(n){var l=n.latlng,s=L.featureGroup(),i=L.stamp(s);if(e.showSearchLocation){var c=L.marker(n.latlng,{type:"query"}).bindTooltip("lat="+l.lat+" lng="+l.lng+"</P>");L.stamp(c),s.addLayer(c)}a.geocode({location:{lat:l.lat,lng:l.lng}},(function(a,n){if("OK"===n)if(a[0]){var u=a[0];if(!$.isEmptyObject(r)){var d="<div>";d=d+"Address: "+(u.formatted_address?u.formatted_address:"")+"<br/>",d+="</div>",r.innerHTML=d}var h=L.latLngBounds(L.latLng(u.geometry.viewport.f.f,u.geometry.viewport.b.b),L.latLng(u.geometry.viewport.f.b,u.geometry.viewport.b.f));if(e.showBounds){var g=L.rectangle(h,{weight:2,color:"#444444",clickable:!1,dashArray:"5,10",type:"result_boundingbox"});L.stamp(g),s.addLayer(g)}if(e.showFeature){var m=L.circleMarker(L.latLng(u.geometry.location.lat(),u.geometry.location.lng()),{weight:2,color:"red",dashArray:"5,10",clickable:!1,type:"result_feature"});L.stamp(m),s.addLayer(m)}var y=s.getLayers();!$.isEmptyObject(y)&&y.length>=0&&($.isEmptyObject(c)||(c.on("mouseover",(function(e){$.isEmptyObject(g)||(g.setStyle({fillOpacity:.5,opacity:.8,weight:5}),g.bringToFront()),$.isEmptyObject(m)||(m.setStyle({fillOpacity:.5,opacity:.8,weight:5}),m.bringToFront())})),c.on("mouseout",(function(e){$.isEmptyObject(g)||(g.setStyle({fillOpacity:.2,opacity:.5,weight:2}),g.bringToBack()),$.isEmptyObject(m)||(m.setStyle({fillOpacity:.2,opacity:.5,weight:2}),m.bringToBack())}))),t.layerManager.addLayer(s,"search",i,o),e.fitBounds&&t.fitBounds(s.getBounds())),HTMLWidgets.shinyMode&&Shiny.onInputChange(t.id+"_reverse_search_feature_found",{query:{lat:l.lat,lng:l.lng},result:u})}else $.isEmptyObject(r)||(r.innerHTML="No Results Found"),console.error("No Results Found");else $.isEmptyObject(r)||(r.innerHTML="Reverse Geocoding failed due to: "+n),console.error("Reverse Geocoing failed due to: "+n)}))}))}).call(this)},LeafletWidget.methods.addSearchUSCensusBureau=function(o){(function(){var t=this;t.searchControlUSCensusBureau&&(t.searchControlUSCensusBureau.removeFrom(t),delete t.searchControlUSCensusBureau),(o=o||{}).url="https://geocoding.geo.census.gov/geocoder/locations/onelineaddress?benchmark=Public_AR_Current&format=jsonp&address={s}",o.textPlaceholder="Search using US Census Bureau",o.jsonpParam="callback",o.formatData=function(e){var o,t,r={};for(var a in e.result.addressMatches)o=e.result.addressMatches[a].matchedAddress,t=L.latLng(e.result.addressMatches[a].coordinates.y,e.result.addressMatches[a].coordinates.x),r[o]=t;return r},o.marker=L.circleMarker([0,0],{radius:30}),o.moveToLocation&&(o.moveToLocation=function(e,t,r){var a=o.zoom||16,n=r.getMaxZoom();n&&a>n&&(a=n),r.setView(e,a)}),t.searchControlUSCensusBureau=new L.Control.Search(o),t.searchControlUSCensusBureau.addTo(t),t.searchControlUSCensusBureau.on("search:locationfound",(function(o){HTMLWidgets.shinyMode&&Shiny.onInputChange(t.id+"_search_location_found",e(o))}))}).call(this)},LeafletWidget.methods.removeSearchUSCensusBureau=function(){(function(){var e=this;e.searchControlUSCensusBureau&&(e.searchControlUSCensusBureau.removeFrom(e),delete e.searchControlUSCensusBureau)}).call(this)},LeafletWidget.methods.addSearchFeatures=function(o,t){(function(){var r,a=this;if(a.searchControl&&(a.searchControl.removeFrom(a),delete a.searchControl),(t=t||{}).moveToLocation&&(t.moveToLocation=function(e,o,r){var a=t.zoom||16,n=r.getMaxZoom();n&&a>n&&(a=n),r.setView(e,a)}),L.Util.isArray(o))r=a.layerManager.getLayerGroup("search",!0),a._searchFeatureGroupName="search",$.each(o,(function(e,o){var t=a.layerManager.getLayerGroup(o,!1);t?r.addLayer(t):console.warn('Group with ID "'+o+'" not Found, skipping')}));else{var n=a.layerManager.getLayerGroup(o,!1);if(!n)throw'Group with ID "'+o+'" not found';r=n,a._searchFeatureGroupName=o}L.stamp(r),t.layer=r,a.searchControl=new L.Control.Search(t),a.searchControl.addTo(a),a.searchControl.on("search:locationfound",(function(o){t.openPopup&&o.layer._popup&&o.layer.openPopup(),HTMLWidgets.shinyMode&&Shiny.onInputChange(a.id+"_search_location_found",e(o))}))}).call(this)},LeafletWidget.methods.removeSearchFeatures=function(e){(function(){var o=this;o.searchControl&&(o.searchControl.removeFrom(o),delete o.searchControl),e&&o._searchFeatureGroupName&&(o.layerManager.clearGroup(o._searchFeatureGroupName),delete o._searchFeatureGroupName)}).call(this)}})();
//# sourceMappingURL=lfx-search-bindings.js.map